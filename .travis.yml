sudo: required

language: node_js

node_js:
  - '13'

services:
  - docker

before_install:
  - docker image build -t lutaev/richi-fe:latest .

before_script:
  - npm install

script:
  - npm run migrate:test
  - npm run test
  - docker run -p 80:3000 lutaev/richi-fe:latest

deploy:
  provider: elasticbeanstalk
  access_key_id:
    secure: "OzI00VLVr6l3DeiOf27uJoiYBOjBnmB1PV3mnhHhAWeMANh95juTq4Cax/LJ8VWyjasJnqZ64THsOa/W0IUZI8+oscR9LjC3NZ55iBJzm9IcN5Ool0/EVrwhRbZ3WP+epvDfACFQlkxAlFD4F85GKw3CrxRusbaeVFJSJjkWczfjNXaJ3Kv8TbOckHIFtfncj0NXgYl6yJ3svm8aKQWWlfbwQ21f4K1DwmuWXlZCALAPgaDfSC/pi3qpDGx4ZK9NGaBXsi7FRXpvcXj5v6WJk8p/9V7DiUUzbuwnK7cec8c9xKO7UKIq7DDlS5KmUxqYinxUkjFwBamsfQdOJjhiuibivDzLtcqIZNjDs3DyVwQGnht23vRBxa6JwrG6SknRUvCm7tFfxDKVY/civ2bv4BwbPr3HjYarx6OT6KgH6Q3a8UGDnHbz6+a5hi4r5XtvE5HR7KuSetTLRXweUnmco24unHcDmJXaosL9Uvi9SVOCxx94QDIABO8PorP6kZtE/wiUMR/PosE0wmx/KBtlIFAsPb08FFOfkPypBEEy5MhINTzbDfN+ZIhlu5o/OCmoF7eAm8sSsTf6uFtLan9x9xu9qzv4C7RFLURHG5IS0ILMqwqTyaIHhRAmfEdwI/g6LrFYpSmNhnXUrWf3q8EyfNmJBOnUhnr3FBnZ/5AXiz0="
  secret_key_id:
    secure: "rraDsWNSq2go4k1yUzqDn37yVnem5TjkNZbbLpsxuW6Zbk3SrXB2nId3kSXZcWxlbATPc3nRVR9cRtIwnShcGz+kSfEbGdlAA2R9rvuqMctdofiomkVnbIF9/MISnOXDWH+TGaV4ezulVK1+tMPWZLNaM+S4I/MYizR1fXOG/lOeMka2ggMFc4IZ9k2K2M7swRsw2dXnq4/JQ+hQKpctrke3rqf5hHpBlO2uNktPzXjung/u4IEjCXBFOabxZ++6yyyVx6R/aQHUSwUjboVmEYPrmSRnkbl08TEDZYcbi5KGhsYg9Hwx66odglFWH+770Wb/hzFnfp3RDD9BDaF6pNwH/Z+u/RXK3rbx7Y1yCJFvfPNV3ZiOjvxDzAryCgVz4vbeOC0rtm/kX4MtyXR1koKMjLDvTa7r9/SsJINTtCTLYXa86bhEvDTtDZP9oqwZnyhsp8HRJC4pny0QpPTE33Mdm0/FS93k4oI/lu6I14l/Bk+KItmyaoV9rwUMLi71ae1ky0ztVZ4RhCBmKNrQ2GExvWsX+aUgU9G8rXLXGuMLOvI5uFuQxrhsW2Y9EyJnwDs9LndYpzev2U4UuHlXrTF/6QNyUUYlJgJVfIWieGvovpmSpJDrpG6med73HqQlBFt0yrTRv3yE/Gb4jtFbidaeqZrkOB9cWi9Ih0DlDjc="
  region: "us-east-2"
  app: "richi"
  env: "richi-be"
  bucket: "elasticbeanstalk-us-east-2-929692614802"
  on:
    branch: master

after_deploy:
  - echo "done deploying"
