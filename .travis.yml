sudo: required

language: node_js

node_js:
  - '13'

services:
  - docker

env:
  global:
    - PG_SQL_USER=hsxyxlxq
    - PG_SQL_HOST=balarama.db.elephantsql.com
    - PG_SQL_DB=hsxyxlxq
    - PG_SQL_TEST_USER=gskibphv
    - PG_SQL_TEST_HOST=drona.db.elephantsql.com
    - PG_SQL_TEST_DB=gskibphv
    - secure: GBKHYfo8ZR9rV6VrNOQjplHlOzft+EGEL91e+3/B/wFe3Z5gAqKIrfn9vJfxqi67vPJfJq4S5FsRJQMe1cyZiwqqOaM4AajQe+QKuNEGr+kDIdFKUNRC4GdboxMwIEAxuD6wzalDbBIDPcRS/Y2AZeJpAeTU3Piji+AxV2sb7LmlU2zuh6HSHzBJJbxkXo/uSf41S7rzih9hvM9jonr/KkVJRTe+pNYC7WhPMETu/mKOMy+0J5AxnWcdHtr5n9SwwDs6kQmUKEpV3zIhRdSXUTZQ4sRUncBmCZblAohJ4fjTH7tK5wi43kGn20j+xoKKB5R1ptq0w/mVymU+NsqyS3KZ+zTaF9iDKqRRf68eX7wRPKdDxHTOfxEafxgUsuSOw4pPxe0IdsQXFUNkYlGqACx9UAR6UtSxfOjoDQ+wWrpFSyDz7YWLrbhQvSIcyLp7lXKKOrZ0T1xrIJL0yb1e3W6I6G2sPFUoeoJjnT1qZXh7+Tmz42BKIrFohD0nzRxu1MsrFPh8xa8P+cVhoblNghbgdK7A3BhWtJLYQtDcAxQj0FmeLYleB5V8rQt/zBb8GOH2wQ5IotIqO5Qb2iNCAuu4MtqgD9U7NZgLARxkqf5IyTwEYG4/ZJ+q8/+xxMRT/sx+MV9NmGRkjb9AzI2I1bipkfDY/ywgNFwa4JgobMk=
    - secure: CWKJeAWNn8C2ziy19a50qGLnZkwfp0u5nV+jpQ9vKseEH4oUjcteyuA4amYHY8vCzmNxdcDErezlaBwJ0yiPx1xbCMipsZLAy3oQcKlOPKdqm3DqQAarBq9PYf2LXjisFYsmDJz248rTXI4j9Waddy+Th9PAMDp3srKreR+9vEhi+BE3Mxy03+NbfI3jhc9OuRTofLHv6Vzm+4tYxgE/ODsGpCu31rTBrFzOGdhXB4eLwhOi1qV7IWWD6L4lmJx9DPsLgyt3cZKvV1mbNNz2I/JTHju4IccUx0Ro+b+ZDFarVdXEzuqI1dehHuVry/XWRa7OGpN/nSSK52IWd6cRG6GgTjWE55AACveexTM4Ob5qn/OgVRJBPllnEsEVlUlKzxZe/4RlKY7fNfbpAp+qBW5qFvFJJoopXkX5uiSeziXOaQETKCGJcoyBOlDTLLN5KYAEI+FDKIom/ynajnsb9ACxkQioBuOQA98I3YXGAOAYkCySh+EuAmFPMNRKgoAVGrq5Dz6DznPM2JDQDWppf6hZQSV1Sv2B64l8h6BahD4wb5MLuE9sBYXmKW4iJwN+sfn9I41afIpoQSRC0j+7NeMyY4AovUgEd7iK0xhuxT3sMV6oNQnVUm3rUhRB91BokqIUPr/ybUHcFmLAeA9pddNTo3GO+cfdaf+JEZ92nqo=
    - secure: Xqmy6nCwjZskJrYZSW4Be9gsieldXry3tRpLJX8kdkLvwpEmHxSpdsu+a9NKN2nPU4PE1Gx5V3d6CUKaZg/8sdCfvibGNKVyDIcXtdryomCWTQn2b9UxfAP3G14QS5M68Ym5PUjgg96USU8ln71Ilm9NwTswP5bV2c5UIFOn2FSuqp0zWBTUYA+snnveJpj3L86UJTI9E7azuQqbfzDOYOEH52ZCMmgKFiwUX0ZR4mpxlCBwrLqf5FXQK0fNDoOUOndr9Bif7wuGbVbr5KFwxfsZ/VF7wgcclNz57kfvJIYr3SorUlyEzASmGCuw6qVq82X6XnljAEOpfgDT54QhBumeo0hqdygNxBGN0pXSuXyhEynoH0GmMjCO1BURYF4u45VtPYfeevfu2ZCAZYynNxqlRenSpu0xL98h4gwDYejP32zIQxfesj1EMmgchruvJmzyHPFsikG+wds9acjxkvcZDsaDkfXsLwrQ3YYnzZZ1yAuJrwXizZGftNaUnidYpIzdh71TvwEUyVLI2yMRBE2CNg8bQXwqh2CWBwk821xtzi4+gc9JKdCfDB72xHffiETkdwicAVKxCEVal5M86pU4KQCEoGxmRMpaGLuf5UyrgwpIASLo6fWpWA2wUupErg3tp6zDLj/pMP7iDCItfzQ4uLgnTpVrVbyhvQPkICI=

before_install:
  - docker image build -t lutaev/richi-fe:latest .

before_script:
  - npm install

script:
  - npm run migrate:test
  - npm run test
  - docker run -p 80:3000 lutaev/richi-fe:latest

deploy:
  provider: elasticbeanstalk
  access_key_id:
    secure: "OzI00VLVr6l3DeiOf27uJoiYBOjBnmB1PV3mnhHhAWeMANh95juTq4Cax/LJ8VWyjasJnqZ64THsOa/W0IUZI8+oscR9LjC3NZ55iBJzm9IcN5Ool0/EVrwhRbZ3WP+epvDfACFQlkxAlFD4F85GKw3CrxRusbaeVFJSJjkWczfjNXaJ3Kv8TbOckHIFtfncj0NXgYl6yJ3svm8aKQWWlfbwQ21f4K1DwmuWXlZCALAPgaDfSC/pi3qpDGx4ZK9NGaBXsi7FRXpvcXj5v6WJk8p/9V7DiUUzbuwnK7cec8c9xKO7UKIq7DDlS5KmUxqYinxUkjFwBamsfQdOJjhiuibivDzLtcqIZNjDs3DyVwQGnht23vRBxa6JwrG6SknRUvCm7tFfxDKVY/civ2bv4BwbPr3HjYarx6OT6KgH6Q3a8UGDnHbz6+a5hi4r5XtvE5HR7KuSetTLRXweUnmco24unHcDmJXaosL9Uvi9SVOCxx94QDIABO8PorP6kZtE/wiUMR/PosE0wmx/KBtlIFAsPb08FFOfkPypBEEy5MhINTzbDfN+ZIhlu5o/OCmoF7eAm8sSsTf6uFtLan9x9xu9qzv4C7RFLURHG5IS0ILMqwqTyaIHhRAmfEdwI/g6LrFYpSmNhnXUrWf3q8EyfNmJBOnUhnr3FBnZ/5AXiz0="
  secret_key_id:
    secure: "rraDsWNSq2go4k1yUzqDn37yVnem5TjkNZbbLpsxuW6Zbk3SrXB2nId3kSXZcWxlbATPc3nRVR9cRtIwnShcGz+kSfEbGdlAA2R9rvuqMctdofiomkVnbIF9/MISnOXDWH+TGaV4ezulVK1+tMPWZLNaM+S4I/MYizR1fXOG/lOeMka2ggMFc4IZ9k2K2M7swRsw2dXnq4/JQ+hQKpctrke3rqf5hHpBlO2uNktPzXjung/u4IEjCXBFOabxZ++6yyyVx6R/aQHUSwUjboVmEYPrmSRnkbl08TEDZYcbi5KGhsYg9Hwx66odglFWH+770Wb/hzFnfp3RDD9BDaF6pNwH/Z+u/RXK3rbx7Y1yCJFvfPNV3ZiOjvxDzAryCgVz4vbeOC0rtm/kX4MtyXR1koKMjLDvTa7r9/SsJINTtCTLYXa86bhEvDTtDZP9oqwZnyhsp8HRJC4pny0QpPTE33Mdm0/FS93k4oI/lu6I14l/Bk+KItmyaoV9rwUMLi71ae1ky0ztVZ4RhCBmKNrQ2GExvWsX+aUgU9G8rXLXGuMLOvI5uFuQxrhsW2Y9EyJnwDs9LndYpzev2U4UuHlXrTF/6QNyUUYlJgJVfIWieGvovpmSpJDrpG6med73HqQlBFt0yrTRv3yE/Gb4jtFbidaeqZrkOB9cWi9Ih0DlDjc="
  region: "us-east-2"
  app: "richi"
  env: "richi-be"
  bucket: "elasticbeanstalk-us-east-2-929692614802"
  on:
    branch: master

after_deploy:
  - echo "done deploying"
